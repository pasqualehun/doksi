\chapter{Elõzmények}


\section{Motiváció}
 
Az MTA SZTAKI Rendszer és Irányításelméleti Kutatólaboratóriumában folyó kutatások eredményének demonstrálására szükség volt egy kézzelfogható eszköz megalkotására. A szabályozó algoritmusok mûködésének bemutatásának az egyik leglátványosabb módja egy repülõgép irányítása.  Egy stabil repülési tulajdonságokkal bíró repülõ levegõben tartása sem triviális, szükség van a kormányszervek harmonikus mozgatására, a tolóerõ szabályzására. Ezen túlmenõen ha feladatokkal látjuk el, pl. fordulópontokat követve feltérképezni az alatta lévõ területet, már számolni kell a széllel, mely eltérítheti az útvonaláról, felszálló légáramlatokkal, melyek ellen gyors reagálással kell válaszolnia. Mivel egy teljesen felszerelt repülõ összeállítása, felprogramozása nagy szakértelmet, sok idõt, energiát igényel és nem utolsó sorban anyagi ráfordítást, egy esetleges meghibásodás jelentõs kárt okozna. Ezen okok miatt felmerült az igény a repülõ megbízhatóságának növelésére, így a most folyamatban lévõ ``Nagy megbízhatóságú pilóta nélküli légijármû projekt'' keretében egy olyan avionikai rendszer fejlesztése is folyik, amelyben cél minden egyes repülõgép alrendszer meghibásodásának diagnosztizálása, a diagnosztikai információkat felhasználva a repülõgép átkonfigurálása. 


\section{Repülõgép felépítése}

A jelenlegi repülõ egy saját építésû 3.2 m fesztávolságú modell, melybe diagnosztikai és hibadetekciós célokra egyedi tervezésû komponensek kerültek. A kommerciális célokra szánt szervo motorok nem szolgálnak elég információval a kitérésükrõl, fogyasztásukról, ezért ezek mérésérõl gondoskodni kellet. 

\begin{figure}[H]
	\centering
	\resizebox{12cm}{!}{
		\includegraphics{figures/orca.png}}
	\caption{}
	\label{fig:sys}
\end{figure}


\section{Hibatûrés}

Elsõdleges szempont, hogy egy komponens meghibásodása ne okozza a gép vesztét, tehát a rendszerben ne maradjon SPOF \footnote{Single Point Of Failure, olyan meghibásodás, mely ha bekövetkezik, az egész rendszer leállásához vezet}. Ezt redundanciával érhetjük el, mely során a repülõgépen duplikáljuk azokat az elemeket, melyek nélkülözhetetlenek a levegõben maradásához:
\begin{itemize}
\item motor
\item kormányfelületek és ezeket mozgató motorok
\item tápellátás
\item központi számítógép
\end{itemize}

A repülõ méretébõl adódóan térbeli szeparációval nem lehetséges a megbízhatóságot növelni, mint pl. harci repülõgépek fedélzeti számítógépeinél, melyek a találat kockázata miatt elszórva, akár 4--5x-ve vannak.

\begin{figure}[!ht]
	\centering
	\resizebox{12cm}{!}{
		\includegraphics{figures/sys.png}}
	\caption{}
	\label{fig:sys}
\end{figure}

 \figref{sys} ábrán látható a kialakított architektúra. A szenzorokból érkezõ jelek a duplázott központi feldolgozó egységekbe jutnak, ahol egy--egy Gateway felelõs a kommunikáció lebonyolításában. A fogadott jelek feldolgozása\footnote{FCC} után a szabályozó algoritmusok kiadják a megfelelõ utasítást a kormányszerveknek. Ilyen utasítás lehet pl, a csûrõlapok adott fokban történõ elmozdítása, motor fordulatszámának változtatása. A motorok, úgy mint a központi egység, külön tápellátást kapnak. A dolgozat szempontjából egyik legfontosabb elem a kommunikációért felelõs modem, mely soros porton keresztül kapcsolódik az FCC-hez. A vevõ oldalon hasonló modem, szintén soros porton küldi a földi állomásnak a vett jelet, a köztük lévõ vezeték nélküli kommunikáció saját szabványa a gyártónak. A választás \cite{bib:xbee}XBee-PRO 868 típusú modemre esett, mely alacsony fogyasztása és nagy hatótávolsága miatt ideális egy ilyen környezetbe.

\section{Vezeték nélküli modem}

A kiválasztott modem kétféleképpen képes kommunikálni:

\begin{itemize}
\item API csomagküldés
\item AT transzparens
\end{itemize}

\textbf{API} módban egy eszköz több eszköztõl tud csomagokat venni, ha egy csomag megérkezett a küldõtõl a fogadóig, egy ACK\footnote{Acknowledgement, nyugtázó üzenet} üzenettel válaszol, ha ezt nem kapja meg, újraküldi. Egy csomag többek közt tartalmazza a küldõ és a fogadó címét, lehetõség van broadcast üzenetek küldésére is, melyet minden eszköz megkap. Továbbá az adatintegritás céljából checksum mezõjében összesítve van egy csomag adata.


\textbf{AT} mód nem más mint egy vezeték nélküli kapcsolat 2 sorosport közt. Nem csinál mást, mint a soros portján bejövõ adatokat egy XBee szabvány szerint rádiójelekké alakítja, melyet a virtuális kapcsolat végpontja fogad és visszaalakítja soros portra. Ez pont-pont kommunikációra hivatott.


\begin{figure}[!ht]
	\centering
	\resizebox{7cm}{!}{
		\includegraphics{figures/xbee.png}}
	\caption{}
	\label{fig:xbee}
\end{figure}


\section{Földi állomások}

Egy UAV vezetéséhez elengedhetetlen egy bázis, ahonnan a földi személyzet irányítja, monitorozhatja a repülést. Általában több \cite{bib:aimofuav} funkciót lát el:
\begin{itemize}
\item Küldetés tervezés: útvonal meghatározása, illetve a célpontok kijelölése
\item Küldetés végrehajtás: távirányítással vezetve az operátor végrehajtja a feladatot
\item Adatok megjelenítése: megfelelõ módon kijelezni a repülõgép állapotát, esetleges hibáit
\end{itemize}



Számos megoldás született a földi állomás GUI\footnote{Graphics User Interface, grafikus megjelenítés}-jának kialakítására. Elsõdleges követelmény, hogy az operátor mindig a legfontosabb információkat láthassa, ehhez szoftverergonómiailag kell megtervezni a mûszerek. \cite{bib:multimodal} Kísérleteket folytattak, milyen elrendezésben, hány képernyõn érdemes megjeleníteni az adatokat, úgy, hogy az még ne terhelje túl az operátort. Bebizonyosodott, hogy érdemes több érzékszerven keresztül jelzéseket adni, így pl. nagy prioritású eseménynél a figyelmeztetõ ablak megjelenését hanghatás is kíséri. Alábbiakban összehasonlításra kerülnek a piacon lévõ megjelenítési felületek, megoldások.


\subsection{ArduPilot}

Az \cite{bib:ardu} Ardupilot projekt létrejöttének oka, hogy otthoni körülmények között, nem ipari alkatrészekbõl bárki összeállíthasson egy autonóm jármûvet, mely az elõre betáplált utasításokat végrehajtja. Központi eleme az Arduino cég által készített ATMel mikroprocesszorra épített platform, mely felhasználóbarátabbá teszi a mikroprocesszor programozását. Magas szintû utasításokkal segíti az eszközzel való barátkozást, nincs szükség assembly szintû tudásra. Erre a platformra hozták létre az ArduPilot programot, képes vezérelni többféle autonóm jármûvet:
\begin{itemize}
\item ArduPlane néven futó változat: robotrepülõgép
\item ArduCopter: 1, 3, 4, 6, 8, propelleres helikopter
\item Ardurover: 4 kerekû autó
\end{itemize}
Sikerességének fõ oka, a nyílt forráskód, Arduino panel alacsony ára (~5 ezer Ft) és a projekt mögött álló lelkes közösség.

Ennek a közösségnek köszönhetõen született a Mission Planner nevû szoftver, mely teljes körû támogatást nyújt a jármûvekkel kapcsolatban.


\subsubsection{Fõképernyõ}

Több nézet segítségével könnyen átlátható a funkcionalitása, repülés szempontjából a fõképernyõn a legfontosabb adatok találhatóak. A repülõgép orientációját, sebességét, irányát egy mûhorizonton láthatja a felhasználó, ez vizuálisan szemlélteti, hogy hány fokos bedöntéssel repül, milyen állásszöggel emelkedik. Alatta lévõ területen elõre beállított adatokat jelenít meg, pl. GPS magasság, GPS sebesség, szélirány( valós mágneses irány és a sebesség vektor különbségébõl számítható). A legnagyobb területet a térkép foglalja el, melyen az aktuális irány, lerepült útvonal, fordulópontok láthatóak. Megfigyelhetõ, hogy ez kapja arányaiban a legnagyobb területet.

\begin{figure}[H]
	\centering
	\resizebox{15cm}{!}{
		\includegraphics{figures/ardu.png}}
	\caption{}
	\label{fig:ardu}
\end{figure}

Ez a nézet akkor jöhet jól, mikor olyan meghibásodás történik, melyre nincs felkészítve az irányítóegység és szükséges lehet a kézi üzemmódra váltás. Elõfordulhat ilyen esetben, hogy nincs vizuális rálátás az operátor és a repülõgép között, ekkor csak az itt látható mûszerek és térkép alapján szükséges irányítania. Szerencsére ez az avionikában már bizonyított, hogy mûszerek segítségével, ``vakon'' is lehetséges repülni, itt azonban ez az eset csak pár percig szükséges.

\subsubsection{Tervezõ és útvonalfeltöltõ}

Másik nézet lehetõséget biztosít útvonalpontok kijelölésére, az útvonalpontokhoz egy listából kiválasztható, hogy az adott pont start-, forduló-, végpont és egyéb lehetõségek. Az útvonalpontok pozícióját egérrel módosíthatjuk, törölhetjük. Bal felsõ sarokban a kijelölt tervnek hosszát láthatjuk, ez segítséget nyújt, nehogy túlhaladjuk a rádiókapcsolat és a repülõ hatósugarát. Az elkészített tervet feltölthetjük a csatlakoztatott eszközre.
\begin{figure}[H]
	\centering
	\resizebox{15cm}{!}{
		\includegraphics{figures/ardu.png}} %plan
	\caption{}
	\label{fig:ardu_plan}
\end{figure}

\subsubsection{Beállítások}

Itt lehetõség van a nyelv és mértékegységek kiválasztására, naplózás sûrûségének meghatározására.
Egy másik oldalon az aktuális jármûvet lehet beállítani, mivel más adatok fontosak egy földi és egy légi jármû esetében, továbbá a kommunikációs protokoll is változó. Nem külön oldalon, hanem mindig látható a csatlakozás gomb, melynél a soros port és a jelsebesség beállítása után a csalatkozás gombbal csatlakozik a program a portra.
\begin{figure}[H]
	\centering
	\resizebox{5cm}{!}{ 
		\includegraphics{figures/ardu.png}} %conn
	\caption{}
	\label{fig:ardu_plan}
\end{figure}
\subsubsection{Terminál}

Ezen az oldalon az USB-n csatlakoztatott eszközt lehet parancssoron konfigurálni. Az eszköz saját LOG fájljait letölteni.

\subsubsection{Egyéb képernyõk}

Lehetõség van még az elmentett log fájlok szimulálására, van egy súgó oldal a program használatával kapcsolatban, illetve egy támogatói gomb, mely átirányít egy PayPal oldalra, ahol különbözõ összeggel támogathatjuk a fejlesztést.


\subsubsection{Összegzés}

Felhasználói szempontból barátságos felületet biztosít a különbözõ nézetekkel, gombok átgondolt elhelyezésével.
Nem a program hibája, de nincs felkészítve párhuzamos csatornák kezelésére, ez az ArduPilot projekt egyszerûségének köszönhetõ, mivel nem használ redundanciát. De mivel a repülõ, melyhez a program készül, nagy megbízhatóságú, így szükséges megoldani a 2 port kezelését, és az azokon érkezõ adatok feldolgozását. Jó ötlet a csatlakozás gomb mindig látható elhelyezése, a fõképernyõn térképen ábrázolni a repülõ helyzetét, illetve a mûhorizont. Azonban hibadiagnosztikai kijelzés nincs megoldva, melynek szintén fontos a megvalósítása.

\subsection{Paparazzi}
\cite{bib:paparazzi}Ez egy több platformos GCS, mely különbözõ projektekben létrehozott repülõkhöz használható valós-idejû monitorozásra. Könnyen testre szabható az igényeknek megfelelõen.




\subsection{MicroPilot}

\cite{bib:makkay} Az 1995 óta mûködõ kanadai \cite{bib:micropilot} MicroPilot a világ egyik legismertebb robotpilóta gyártó cége. A néhány száz grammos repülõ modelltõl a gázturbinás repülõkig 60 országban több mint 600 alkalmazó használja az eszközeiket. Népszerûek az iskolákban, egyetemeken, kutató intézetekben, a gazdaság különbözõ területein, de a védelmi szféra is szép számmal használ robot légi jármûvein MicroPilot berendezéseket. A MicroPilot a repülõgép fedélzetére teljes duplex adatátviteli berendezést ajánl. A 2,4 GHz-es ipari csatornán mûködõ berendezéssel, irányított antennával akár 20 km-es hatótávolság is elérhetõ. A földi állomás irányított antennával követi a repülõgépet, ami megnöveli a hatótávolságot és az adatátvitel biztonságát különösen a gyakran manõverezõ, nagy bedöntésû fordulókat végrehajtó légi jármûvekkel. Az adatátviteli berendezés állapota a földi állomás jelzõfényei alapján ellenõrizhetõ, mindemellett a MicroPilot Horizon program képernyõjén a status sorban a zöld mezõ (LINK) jelzi a folyamatos adatkapcsolatot. Az adatátviteli csatorna ugyanazokat a funkciókat képes biztosítani, mint a programbevitelnél használt kábeles összeköttetés, így ezen keresztül repülés közben is módosítható az útvonal, a repülési paraméterek és az egyéb beállítások. A MicroPilot fedélzeti egysége ezen kívül egy rádió távirányító (RCON) vevõberendezést is fogad, amely lehetõséget teremt a földi adó konzoljáról az irányítás átvételére és  botkormányos kézi vezérlésre. Ezt alapvetõen a fel és leszállás idejére, illetve az útvonal kritikus szakaszain használják akkor, ha az automatikus üzem valamilyen okból nem biztosítható. Ez következhet be az adatkapcsolat megszakadásakor ilyenkor a beállított üzemmódnak megfelelõen vagy köröz az utolsó koordináta körül, vagy elindul a leszállóhely felé (ami nem feltétlenül a felszállóhely) majd a kapcsolat helyreállítóval folytatja a feladatot. Amennyiben az RC távirányítóval mûködõ repülõgép veszti el a kapcsolatot, akkor a fedélzeti vevõberendezés FAILSAFE üzemmódra kapcsol és annak beállítása szerint mûködteti a repülõgépet. A FAILSAFE vagy az utolsó szervó állást õrzi meg, vagy egy elõre programozott legbiztonságosabb földet érést ígérõ beállításra ugrik. 


%http://www.szrfk.hu/rtk/folyoirat/2013_1/2013-1-04-Imre_Makkay.pdf
%http://www.szrfk.hu/rtk/kulonszamok/2012_cikkek/77_Makkay_Imre-Papp_Timea.pdf
%http://www.unmannedgroup.com/index.php?page=2&subpage=6&data=9
%http://www.uavfactory.com/product/16


\subsection{OpenPilot}
\cite{bib:openpilot}


\subsection{HumanPower}
\cite{bib:humanpower}


\subsection{HappyKillmore}
\cite{bib:hk} Ez a GUI az ArduPlane nevû nyílt forráskódú, háziépítésû UAV-hoz készült.
Itt is a térkép nézet dominál, oldalt mozgathatjuk számunkra megfelelõ elrendezésbe a mûszereket.
Több különbözõ oldal közül választhatunk, ha pl. a bejövõ adatokra vagyunk kíváncsiak vagy a soros port port számát szeretnénk beállítani. Lehetõségünk van exportálni is az adatokat.


\begin{figure}[!h]
	\centering
	\resizebox{10cm}{!}{
		\includegraphics{figures/hk.png}}
		\caption{}
	\label{fig:hk}
\end{figure}



\subsection{Viking}
\cite{bib:viking} Itt egyértelmûen a térkép feletti pozíción van a hangsúly, jobb oldalt néhány mûszer, illetve a fontosabb adatok számokkal


\begin{figure}[!ht]
	\centering
	\resizebox{10cm}{!}{
		\includegraphics{figures/viking.png}}
	\caption{Viking}
	\label{fig:viking}
\end{figure}
